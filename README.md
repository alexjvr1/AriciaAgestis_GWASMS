# AriciaAgestis_GWASMS
GWAS using ddRAD and WGS in combination with female preference data

## Background

Brown Argus has expanded their range under warming climate conditions, which has resulted in the colonisation of sites where their preferred host plant, Rock rose, is less prevalent. A shift in host plant preference to Geranium has been observed in the newly colonised populations, as well as a reduced preference for females to lay there eggs on Rockrose, which suggests specialisation and loss of variation associated with the range expansion. 

Population genomic analyses have found outlier loci associated with the host-plant shift which were spread across several scaffolds. The origin of the loci could not be determined by demographic analyses (due to too few independent loci called in the ddRAD data), and most of the strong outliers could not be mapped to the de novo genome assembly, we have since gained access to the chromosome-level Brown Argus genome generated by Sanger. However, we found that the adaptive genotypes occur exclusively in the new part of the range. This suggests that host-plant shift is facilitated by a forming novel genotypes rather than through the increased success/survival of a pre-adapted genotype from the established part of the range (where BA utilise both Geranium and Rockrose, but prefer Rockrose). 

A major question is if 


The [Falconer Shiny app](https://github.com/CNSGenomics/falconer-shiny) is useful for illustrating the effects of polygenic traits on genetic variance and genetic variance components. [REF](https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1009548)

## Aims

1) Establish if female host-plant preference from the established and new part of the range differs in common garden choice experiments. And determine if variance in host plant preference is reduced in the new part of the range, which would suggest specialisation and loss of their ability to choose Rockrose.
  
  (a) Are there differences in HP between old and new sites, or within old and new; 
  
  (b) Is there significant variation among vs within females; 
  
  (c) Is among female variation greater in old vs new sites

2) Identify loci associated with Geranium preference using a GWAS approach. 

  (a) GWAS between old and new

  (b) GWAS within old and within new
  
3) Identify the loci and genomic locations of the loci associated with host plant choice, and determine if these are the same loci identified in the outlier analysis in the PopGen MS. 


4) Identify loci of interest in the regions surrounding the GWAS outliers
  
 We have high coverage whole genome sequence data for a set of samples (NBAF). These can be used to explore the genomic regions around the ddRAD loci identified as outliers in the GWAS analysis. 
 
 (a) SNP calling with Sanger genome (and NBAF data); testing for outliers between old and new, and within old and new.

(3) GWAS (providing 1b is true...)

(4) Do regions from (3) match outlier regions in (2)



## 1.RawDatatoVariants.md

1.1 Call variants for ddRAD samples after mapping to the new Sanger genome. 

1.2 Call variants for NBAF whole genome sequenced samples after mapping to the new Sanger genome

For the WGS NBAF data each sample was sequenced across four lanes, so we have 4 fastq.gz files for each individual for each direction (fwd and rev). 
I'm concatenating these together just using cat before mapping to the new genome: 

```
cat *L01_1.fastq.gz > BAR_1_2013.WGS_1.fastq.gz

#Check this has worked: 
du -chs *L01_1*gz
924M	190905_E00306_0448_AH2LF3CCX2_5_11696BJ0065L01_1.fastq.gz
840M	190905_E00306_0448_AH2LF3CCX2_6_11696BJ0065L01_1.fastq.gz
755M	190905_E00306_0448_AH2LF3CCX2_7_11696BJ0065L01_1.fastq.gz
485M	191010_E00306_0453_AH37FMCCX2_1_11696BJ0065L01_1.fastq.gz
3.0G	total

du -chs *WGS*gz 
3.0G	BAR_1_2013.WGS_1.fastq.gz
3.3G	BAR_1_2013.WGS_2.fastq.gz
```


Concatenate the ddRAD and WGS datasets as described [here](https://github.com/alexjvr1/AriciaAgestis_GWASMS/blob/main/Intersect_ddRAD%26WGS.md)




## 2.SNPFiltering.md

Filter SNPs from the ddRAD samples


## 3.PhenotypeData.md



## 4.GWASwithGEMMA.md
